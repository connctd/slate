# Units

A unit is a primitive container that gives developers the possibility to group things and to put them into a context. Since a unit can reference other units (children and parents) even complex structures of the real world can be modeled like for example a city with it's streets and buildings.

<aside class="notice">
  When doing requests against our units endpoint you have to pass two headers for a successful request handling:
  <ul>
    <li>Authorization:Bearer -your token-</li>
    <li>X-External-Subject-Id:-any id (e.g. customer id) generated by your app-</li>
  </ul>
</aside>

## Model 

```json
{
  "id": "<Generated id>",
  "name": "<Name of unit>",
  "type": "<Type of unit>",
  "things": [{"href":"https://api.connctd.io/api/v1/things/ab..."}],
  "properties": ["tuple(name,json object)"],
  "children": [{"href":"https://api.connctd.io/api/v1/units/xy..."}],
  "parents": [{"href":"https://api.connctd.io/api/v1/units/qw..."}],
  "subjects": [{"href":"https://api.connctd.io/api/v1/subjects/98..."}],
  "owner": "65...."
}

```

On the right hand side you can see an exemplary unit. We also offer a [unit json schema](https://github.com/connctd/future-platform/blob/master/domain/unit-schema.json) which allows json object validation.

The unit **type** helps to interprete the meaning of a unit. It is meant to be kept very generic like "ROOM" OR "BUILDING" instead of using too meaningful types like "BATHROOM". If your app requires more information about a unit it is a good way to describe them within the **properties**. Those properties can hold arbitrary information since json objects can be passed. Even json ld is allowed to semantically enrich them. A json ld processor takes care of object validation.

The values of the properties **parents**, **children**, **subjects** and **things** are lists holding references to other resources.

## Create unit

> **Request**<br>
> POST https://api.connctd.io/api/v1/units<br>
> *Headers:*<br>
> &nbsp;Content-Type:application/json<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* see below<br>

```json
{
  "name": "My House",
  "type": "HOUSE",
  "properties": [
    {
      "name":"address",
      "value":{
        "number":"25",
        "street":"..."
      }
    }
  ]
}
```

> **Response**<br>
> *Code:* 201<br>
> *Body:* Id of newly created unit. See example below

```json
{
  "id": "e1de3bcf-7699-4838-97ec-635618fb3caa"
}
```

Creates an empty unit. Additional information like parents, children or subjects can be added by subsequent calls.

Required scope: `connctd.units.admin`

## Retrieve units

> **Request**<br>
> GET https://api.connctd.io/api/v1/units<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* Array of units. See example below

```json
[
  {
    "href": "https://api.connctd.io/api/v1/units/37cbbcfb-9a5c-4931-aa55-f73ff0af0e80"
  }, ...
]
    
```

Retrieves a list of resource links to units the user belongs to

Required scope: `connctd.units.read`

## Retrieve unit

> **Request**<br>
> GET https://api.connctd.io/api/v1/units/-unitId-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* A single unit. See example below

```json
{
  "id": "e1de3bcf-7699-4838-97ec-635618fb3caa",
  "name": "My House",
  "type": "HOUSE",
  "things": [],
  "properties": [
    {
      "name": "details",
      "value": {
        "number":25,
        "street":"..."
      }
    }
  ],
  "children": [],
  "parents": [],
  "subjects": [],
  "owner": "1"
}   
```

Retrieves a unit by id

Required scope: `connctd.units.read`

## Delete unit

> **Request**<br>
> DELETE https://api.connctd.io/api/v1/units/-unitId-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 204

Removes a unit by its id.

Required scope: `connctd.units.admin`

## Get unit references

> **Request**<br>
> GET https://api.connctd.io/api/v1/units/-unitId-/-parents|children-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* List of unit references. See example below

```json
[
  {
    "href": "https://api.connctd.io/api/v1/units/1376f734-dbfc-486d-b264-f62d3ff88579"
  }, ...
]
```

Retrieves a list of unit references.

Required scope: `connctd.units.read`

## Add unit reference

> **Request**<br>
> POST https://api.connctd.io/api/v1/units/-unitId-/-parents|children-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* Id of parent/child. See example below<br>

```json
{
  "id": "1376f734-dbfc-486d-b264-f62d3ff88579"
}
```

> **Response**<br>
> *Code:* 201

Adds a reference to another unit. The reference also appears within the referenced unit either as parent or child reference.

Required scope: `connctd.units.admin`

## Remove unit reference
 
> **Request**<br>
> DELETE https://api.connctd.io/api/v1/units/-unitId-/-parents|children-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* Id of parent/child unit. See example below<br>

```json
{
  "id": "1376f734-dbfc-486d-b264-f62d3ff88579"
}
```

> **Response**<br>
> *Code:* 204

Removes a reference to another unit. The reference also disappears from within the referenced unit.

Required scope: `connctd.units.admin`

## Get subject references

> **Request**<br>
> GET https://api.connctd.io/api/v1/units/-unitId-/subjects<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* List of subject references. See example below

```json
[
  {
    "href": "https://api.connctd.io/api/v1/subjects/123-55664-aab-2456"
  }
]
```

Retrieves list of subject references

Required scope: `connctd.units.read`

<aside class="note">
Subject references can be used to assign (external) subject ids to a specific unit. As soon a one external subject (lets say for example S1) is assigned to the unit of another subject (lets say S2), the result list when retrieving the units of S1 will contain the unit of S2.   
</aside>

## Add subject reference
 
> **Request**<br>
> POST https://api.connctd.io/api/v1/units/-unitId-/subjects<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* Id of subject. See example below<br>

```json
{
  "id": "any id your application is working with - e.g. customer id"
}
```

> **Response**<br>
> *Code:* 201

Adds a reference to a subject.

Required scope: `connctd.units.admin`

## Remove subject reference

> **Request**<br>
> DELETE https://api.connctd.io/api/v1/units/-unitId-/subjects<br>
> *Headers:*<br>
> &nbsp;Content-Type:application/json<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* Id of subject. See example below<br>

```json
{
  "id": "123-55664-aab-2456"
}
```

> **Response**<br>
> *Code:* 204

Removes a reference to a subject.

Required scope: `connctd.units.admin`

## Get properties
 
> **Request**<br>
> GET https://api.connctd.io/api/v1/units/-unitId-/properties<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* List of properties. See example below

```json
[
  {
    "name": "address",
    "value": {...}
  }
]
```

Retrieves a list of all properties

Required scope: `connctd.units.read`

## Get property

> **Request**<br>
> GET https://api.connctd.io/api/v1/units/-unitId-/properties/-propertyName-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* A single property. See example below

```json
{
    "name": "number",
    "value": {...}
}
```

Read a specific property

Required scope: `connctd.units.read`

## Add property

> **Request**<br>
> POST https://api.connctd.io/api/v1/units/-unitId-/properties<br>
> *Headers:*<br>
> &nbsp;Content-Type:application/json<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* New property. See example below<br>

```json
{
    "name": "MyNewProperty",
    "value": -any json(-ld)-
}
```

> **Response**<br>
> *Code:* 201

Adds a new property.

Required scope: `connctd.units.admin`

## Update property

> **Request**<br>
> PUT https://api.connctd.io/api/v1/units/-unitId-/properties<br>
> *Headers:*<br>
> &nbsp;Content-Type:application/json<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* New property value. See example below<br>

```json
{
    "name": "MyNewProperty",
    "value": {...}
}
```

> **Response**<br>
> *Code:* 204

Updates a property.

Required scope: `connctd.units.admin`

## Delete property

> **Request**<br>
> DELETE https://api.connctd.io/api/v1/units/-unitId-/properties/-propertyName-<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200

```json
```

Removes a property from property set

Required scope: `connctd.units.admin`

## Get thing references
 
> **Request**<br>
> GET https://api.connctd.io/api/v1/units/-unitId-/things<br>
> *Headers:*<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* empty<br>

```json
```

> **Response**<br>
> *Code:* 200<br>
> *Body:* List of thing references. See example below

```json
[
  {
    "href": "https://api.connctd.io/api/v1/things/591327fe-5c1a-4dbb-a96b-9bef4de0a273"
  }, ...
]
```

Retrieves a list of all thing references

Required scope: `connctd.units.read`

## Add thing reference
 
> **Request**<br>
> POST https://api.connctd.io/api/v1/units/-unitId-/things<br>
> *Headers:*<br>
> &nbsp;Content-Type:application/json<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* Id of thing. See example below<br>

```json
{
  "id": "591327fe-5c1a-4dbb-a96b-9bef4de0a273"
}
```

> **Response**<br>
> *Code:* 201

Adds a reference to a things.

Required scope: `connctd.units.admin`

## Remove thing reference

> **Request**<br>
> DELETE https://api.connctd.io/api/v1/units/-unitId-/things<br>
> *Headers:*<br>
> &nbsp;Content-Type:application/json<br>
> &nbsp;Authorization:YOUR TOKEN<br>
> &nbsp;X-External-Subject-Id:SUBJECT_ID<br>
> *Body:* Id of thing. See example below<br>

```json
{
  "id": "591327fe-5c1a-4dbb-a96b-9bef4de0a273"
}
```

> **Response**<br>
> *Code:* 204

Removes a reference to a thing.

Required scope: `connctd.units.admin`

